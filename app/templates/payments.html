<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Paiements - Agence de Voyage</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Gestion des Paiements</h1>
        <nav>
            <ul>
                <li><a href="{{ url_for('index') }}">Accueil</a></li>
                <li><a href="{{ url_for('clients') }}">Clients</a></li>
                <li><a href="{{ url_for('reservations') }}">Réservations</a></li>
                <li><a href="{{ url_for('destinations') }}">Destinations</a></li>
                <li><a href="{{ url_for('flights') }}">Vols</a></li>
                <li><a href="{{ url_for('agents') }}">Espace Agent</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h2>Historique des Paiements</h2>

        <!-- Filters for payment history -->
        <div class="filters mb-3">
            <form action="#" method="GET"> <!-- Action will be handled by backend later -->
                <label for="filter_client_payment" style="margin-right: 5px;">Client ID:</label>
                <input type="text" id="filter_client_payment" name="filter_client_payment" placeholder="ID Client" style="width: 120px; margin-right: 10px;">

                <label for="filter_agent_payment" style="margin-right: 5px;">Agent ID:</label>
                <input type="text" id="filter_agent_payment" name="filter_agent_payment" placeholder="ID Agent" style="width: 120px; margin-right: 10px;">

                <label for="filter_date_from" style="margin-right: 5px;">De:</label>
                <input type="date" id="filter_date_from" name="filter_date_from" style="width: 150px; margin-right: 10px;">

                <label for="filter_date_to" style="margin-right: 5px;">À:</label>
                <input type="date" id="filter_date_to" name="filter_date_to" style="width: 150px; margin-right: 10px;">

                <button type="submit" class="btn">Filtrer</button>
            </form>
        </div>

        <table class="mb-3">
            <thead>
                <tr>
                    <th>ID Paiement</th>
                    <th>ID Réservation</th>
                    <th>Client (ID/Nom)</th>
                    <th>Montant</th>
                    <th>Date Paiement</th>
                    <th>Méthode</th>
                    <th>Statut</th>
                    <th>Agent (ID/Nom)</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Sample Payment Row 1 -->
                <tr>
                    <td>P001</td>
                    <td>R001</td>
                    <td>C001 (Jean Dupont)</td>
                    <td>250.00 €</td>
                    <td>2023-10-16</td>
                    <td>Carte de Crédit</td>
                    <td>Payé</td>
                    <td>A01 (Sophie D.)</td>
                    <td><a href="#invoice-P001" class="btn">Voir Facture</a></td>
                </tr>
                <!-- Sample Payment Row 2 -->
                <tr>
                    <td>P002</td>
                    <td>R002</td>
                    <td>C002 (Alice Martin)</td>
                    <td>120.50 €</td>
                    <td>2023-11-02</td>
                    <td>PayPal</td>
                    <td>Payé</td>
                    <td>Online</td>
                    <td><a href="#invoice-P002" class="btn">Voir Facture</a></td>
                </tr>
                <!-- Sample Payment Row 3 -->
                <tr>
                    <td>P003</td>
                    <td>R003</td>
                    <td>C003 (Paul Lefevre)</td>
                    <td>300.00 €</td>
                    <td>2023-11-05</td>
                    <td>Virement</td>
                    <td>En attente</td>
                    <td>A02 (Marc L.)</td>
                    <td><a href="#invoice-P003" class="btn">Voir Facture</a></td>
                </tr>
            </tbody>
        </table>

        <hr class="mb-3">

        <h2>Exemple de Facture</h2>
        <div id="invoice-P001" class="invoice-display" style="border: 1px solid #ddd; padding: 20px; background-color: #f9f9f9;">
            <h3>Facture #F2023-001</h3>
            <p><strong>Date d'émission:</strong> 2023-10-16</p>
            <p><strong>Client:</strong> Jean Dupont (C001)</p>
            <p><strong>Réservation:</strong> R001 (Vol V789 - Paris)</p>
            <p><strong>Description:</strong> 2 places pour Paris</p>
            <p><strong>Montant Total:</strong> 250.00 €</p>
            <p><strong>Statut:</strong> Payé</p>
            <br>
            <p>Merci pour votre confiance!</p>
            <p><em>Agence de Voyage XYZ</em></p>
        </div>
         <div id="invoice-P002" class="invoice-display" style="border: 1px solid #ddd; padding: 20px; background-color: #f9f9f9; margin-top:15px;">
            <h3>Facture #F2023-002</h3>
            <p><strong>Date d'émission:</strong> 2023-11-02</p>
            <p><strong>Client:</strong> Alice Martin (C002)</p>
            <p><strong>Réservation:</strong> R002 (Vol V790 - New York)</p>
            <p><strong>Description:</strong> 1 place pour New York</p>
            <p><strong>Montant Total:</strong> 120.50 €</p>
            <p><strong>Statut:</strong> Payé</p>
            <br>
            <p>Merci pour votre confiance!</p>
            <p><em>Agence de Voyage XYZ</em></p>
        </div>

    </main>
    <footer>
        <p>&copy; 2023 Agence de Voyage</p>
    </footer>

    <script>
        // Add active class to current page link in nav
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('header nav ul li a');
            let currentPath = window.location.pathname;
            if (currentPath.endsWith('/')) {
                currentPath = currentPath.slice(0, -1);
            }
            const currentPageName = currentPath.split('/').pop().replace('.html', '');

            navLinks.forEach(link => {
                const linkPath = link.getAttribute('href');
                if ( (currentPageName === 'index' || currentPageName === '') && (linkPath.endsWith('/index') || linkPath === '/' || linkPath.endsWith('/index.html')) ){
                    link.classList.add('active');
                } else if (linkPath.includes(currentPageName) && currentPageName !== 'index' && currentPageName !== '') {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
